{% extends "app/layout.html" %}

{% load staticfiles %}

{% block content %}
<div id="attendance-linechart-module" style="width: 1500px;height:1100px;"></div>
{% endblock %}


{#to do: legendData, data(data type, not string)#}
{# legendData = [{%for m in modules %} { { { m.values("name") } } }] #}
{# {% endfor %} #}
{#  data=[{%for s in sessions.get(module=name)%}} #}
{# {{{s.time}},{{s.attendance_rate}},{{s.attendance_rate*100.0}},  "absentStudent List" + v}] #}
{#   {%endfor%}#}



{% block scripts %}
<script src="{% static 'statistics/scripts/echarts.js' %}"></script>
<script type="text/javascript">

    // Chart Object
    var myChart = echarts.init(document.getElementById('attendance-linechart-module'));


    var legendData = ['LAC', 'IIP', 'CPP'];
    var serieData = [];
    for (var v = 0; v < legendData.length; v++) {
        var serie = {
            name: legendData[v],
            type: 'line',
            showAllSymbol: true,
            //define markpoint size
            symbolSize: function (value) {
                return Math.round(value[2] / 10) + 2;
            },

            data: (function () {
                var d = [];
                var len = 0;
                var now = new Date();
                var value;
                while (len++ < 30) {
                    d.push([
                        new Date(2015, 9, v, 0, len * 10000),
                        (Math.random() * 30).toFixed(2) - 0,
                        (Math.random() * 100).toFixed(2) - 0,
                        "absentStudent List" + v
                    ]);
                }
                return d;
           })()
       };
        serieData.push(serie)
    }





    option = {
        title: {
            text: 'Modules Attendance',
            //                subtext: 'Attendance Rate perSession'
        },
        tooltip: {
            show: true,
            trigger: 'item',
            triggerOn: 'click',
            formatter: function (params) {
                return params.value[3];
                //
                //                        var date = new Date(params.value[0]);
                //                        data = date.getFullYear() + '-'
                //                            + (date.getMonth() + 1) + '-'
                //                            + date.getDate() + ' '
                //                            + date.getHours() + ':'
                //                        return data + '<br />'
                //                            + params.value[1] + ', '
                //                            + params.value[2];
            }
        },
        toolbox: {
            show: true,
            feature: {
                mark: { show: true },
                dataView: { show: true, readOnly: false },
                restore: { show: true },
                saveAsImage: { show: true }
            }
        },
        dataZoom: {
            show: true,
            start: 0,
            end: 100
        },

        legend: {
            data: legendData
        },
        grid: {
            y2: 80
        },
        xAxis: [
            {
                name: 'Session Date',
                type: 'time',
                splitNumber: 10
            }
        ],
        yAxis: [
            {
                name: 'AttendenceRate',
                type: 'value'
            }
        ],
        series: serieData
    },






        myChart.setOption(option);

    // student search button
//    window.onload = function () {
//        var bt = document.getElementById("bt2");
//        var btt = document.getElementById("bt1");
//        bt.onclick = function () {
//            alert(bt1.value);
//        }
//    }

//<input type="text" id="bt1" placeholder="6518701" size="5" style="margin: 0 auto;
//                border: 1px solid #ccc;
//                padding: 7px 0px;
//                border-radius: 3px;" /><br>
//<input type="button" id="bt2" value="Search!" />

    </script >
{% endblock %}